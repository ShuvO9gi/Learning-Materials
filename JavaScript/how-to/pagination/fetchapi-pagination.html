<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- Include Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    />
  </head>
  <style></style>
  <body>
    <div>
      <h2>
        Fetch REST API and Pagination in javascript:
        <a href="https://www.youtube.com/watch?v=xqWeLRZFg10&t=623s"
          >Click to Watch</a
        >
      </h2>
    </div>
    <div class="container-fluid mt-4 mb-4">
      <div class="row mb-4 d-flex justify-content-between align-items-center">
        <div class="col-12">
          <h1 class="text-center mb-5"></h1>
        </div>
        <div class="col-12 col-md-6 col-lg-6">
          <div class="sform">
            <form action="#">
              <input type="text" id="search" placeholder="Search here" />
            </form>
          </div>
        </div>
        <div class="col-12 col-md-6 col-lg-6">
          <div class="actions">
            <div class="btn btn-secondary">
              <button id="prevBtn">Prev</button>
              <button id="nextBtn">Next</button>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <div id="product-container"></div>
          <div id="msg" class="text-center"></div>
        </div>
      </div>
    </div>

    <!-- include jQuery and Bootstrap js -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script>
      let apiUrl = "https://dummyjson.com/products";
      let productData = [];
      let itemsPerPage = 12;
      let currentPage = 1;

      async function dataTable() {
        await productTable();
        console.log(productData);

        //pagination
        const pages = [];
        for (
          let i = 0;
          i <= Math.ceil(productData.length / itemsPerPage);
          i++
        ) {
          pages.push(i);
        }

        const indexOfLastPage = currentPage + itemsPerPage;
        const indexofFirstPage = indexOfLastPage - itemsPerPage;
        const currentItems = productData.slice(
          indexofFirstPage,
          indexOfLastPage
        );

        document.getElementById("product-container").innerHTML = currentItems
          .map(
            (products) => `
            <div class="productBox">
                <img src=${products.images[0]} alt="" />
                <p>${products.category}</p>
                <h4>${products.title.slice(0, 14)}...</h4>    
            </div>
                `
          )
          .join(" ");
      }
      dataTable();

      //next and prev button
      const prevBtn = () => {
        if (currentPage != 1) {
          currentPage--;
          dataTable();
        }
      };
      const nextBtn = () => {
        if ((currentPage * itemsPerPage) / productData.length) {
          currentPage++;
          dataTable();
        }
      };

      document
        .getElementById("prevBtn")
        .addEventListener("click", prevBtn, false);
      document
        .getElementById("nextBtn")
        .addEventListener("click", nextBtn, false);

      async function productTable() {
        const data = await fetch(apiUrl);
        const res = await data.json();
        productData = res.products;
        console.log(productData);
      }
    </script>
  </body>
</html>
